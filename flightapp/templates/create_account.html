<!DOCTYPE html>
<html lang="en">
<head>
	<title>Create Account</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="/static/images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/static/css/util.css">
	<link rel="stylesheet" type="text/css" href="/static/css/main.css">
<!--===============================================================================================-->
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
		<div class="container">
		  <a class="navbar-brand" href="index">Fly Like T6</a>
		  <button aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler"
				  data-target="#ftco-nav"
				  data-toggle="collapse" type="button">
			<span class="oi oi-menu"></span> Menu
		  </button>
	  
		  <div class="collapse navbar-collapse" id="ftco-nav">
			<ul class="navbar-nav ml-auto">
			  <li class="nav-item"><a class="nav-link" href="about" style="color:white">About</a></li>
			  <li class="nav-item"><a class="nav-link" href="search_flights" style="color:white">Search Flights</a></li>
			  <li class="nav-item"><a class="nav-link" href="manage_booking" style="color:white">My Bookings</a></li>
			  <li class="nav-item"><a class="nav-link" href="logout" style="color:white">Logout</a></li>
			</ul>
		  </div>
		</div>
	  </nav>

	<div class="container-contact100">
		<div class="wrap-contact100">
			<form class="contact100-form validate-form" id = "create_accountForm">
				<span class="contact100-form-title">
					Create Account
				</span>

				<div class="wrap-input100 validate-input" data-validate="First name is required">
					<span class="label-input100">First Name</span>
					<input class="input100" type="text" name="firstname">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Last name is required">
					<span class="label-input100">Last Name</span>
					<input class="input100" type="text" name="lastname">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Date of birth is required">
					<span class="label-input100">Date of Birth</span>
					<input class="input100" type="date" name="dob">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate = "Valid email is required: ex@abc.xyz">
					<span class="label-input100">Email</span>
					<input class="input100" type="text" name="email">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Phone Number is required">
					<span class="label-input100">Phone Number</span>
					<input class="input100" type="text" name="phonenum">
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Password is required">
					<span class="label-input100">Password</span>
					<input class="input100" type="password" name="password">
					<span class="focus-input100"></span>
				</div>
				
				<div class="wrap-input100 validate-input" data-validate="Passwords do not match">
					<span class="label-input100">Re-enter Password</span>
					<input class="input100" type="password" name="password">
					<span class="focus-input100"></span>
				</div>

				<div class="container-contact100-form-btn">
					<div class="wrap-contact100-form-btn">
						<div class="contact100-form-bgbtn"></div>
						<button class="contact100-form-btn" type = "submit">
							<span>
								Submit
								<i class="fa fa-long-arrow-right m-l-7" aria-hidden="true"></i>
							</span>
						</button>
					</div>
				</div>
			</form>
		</div>
	</div>



	<div id="dropDownSelect1"></div>
<!-- 
=============================================================================================== -->
	<script src="/static/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="/static/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="/static/vendor/bootstrap/js/popper.js"></script>
	<script src="/static/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="/static/vendor/select2/select2.min.js"></script>
	<script>
		$(".selection-2").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect1')
		});
	</script>
<!--===============================================================================================-->
	<script src="/static/vendor/daterangepicker/moment.min.js"></script>
	<script src="/static/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="/static/vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="/static/js/main-ca.js"></script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-23581568-13');
</script> -->

</body>

<script>
	// Helper function to display error message
	function showError(message) {
	  // Display an error under the the predefined label with error as the id
	  $('#error').text(message);
	}
  
	$("#create_accountForm").submit(async (event) => {
	  //Prevents screen from refreshing when submitting
	  event.preventDefault();
	  console.log('hihi');
  
	  var serviceURL = "http://127.0.0.1:5002/passenger/register/";
	  // var homeURL = "http://127.0.0.1/bookstore/";
  
	  //Get form data
	  var email = $('#email').val();
	  var password = $('#password').val();
	  var firstName = $('#firstName').val();
	  var lastName = $('#lastName').val();
	  var dateOfBirth = $('#dateOfBirth').val();
	  var contactNo = $('#contactNo').val();
	  var pid = $('#pid').val();
  
	  serviceURL += email;
  
	  try {
		const response =
		  await fetch(
			serviceURL, {
			  method: 'POST',
			  headers: {"Content-Type": "application/json"},
			  body: JSON.stringify({
				pid: pid,
				password: password,
				email: email,
				firstName: firstName,
				lastName: lastName,
				dateOfBirth: dateOfBirth,
				contactNo: contactNo
			  })
			});
		const data = await response.json();
  
		if (response.ok) {
		  document.location.href = "search_flights";
  
		  // // relocate to home page
		  // window.location.replace(homeURL);
		  return false;
		} else {
		  console.log(data);
		  showError(data.message);
		}
	  } catch (error) {
		// Errors when calling the service; such as network error,
		// service offline, etc
		showError
		("A problem occurred when creating your account, please try again later. " + error);
  
	  } // error
	});
  </script>
  




</html>
